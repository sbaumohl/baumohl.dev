---
import type { CollectionEntry } from "astro:content";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import FormattedDate from "../components/FormattedDate.astro";
import BasePage from "./BasePage.astro";
import { getImage } from "astro:assets"

type Props = CollectionEntry<"blog">["data"];

const { title, description, pubDate, updatedDate, heroImage, author } =
	Astro.props;

const images = import.meta.glob("../images/**");
const heroImageImport: any = await images[`../images/${heroImage}`]()

const loadedImage = await getImage({
    src: heroImageImport.default,
    format: "webp",
    width: 720,
    height: 720,
});

---

<BasePage>
	<body>
		<Header />
		<main class="my-16 md:w-[720px] max-md:p-2 mx-auto">
			<article>
				<div class="hero-image">
					{
						heroImage && (
							<img src={loadedImage.src} alt="" class="mb-16 mx-auto aspect-square" />
						)
					}
				</div>
				<div>
					<h1 class="text-4xl font-bold">{title}</h1>
					<h2 class="text-lg font-medium text-secondary mt-4">
						{description}
					</h2>
					<div class="text-primary mt-8">
						Published <FormattedDate date={pubDate} />
						{
							updatedDate && (
								<div>
									Last updated on <FormattedDate date={updatedDate} />
								</div>
							)
						}
						<div class="text-secondary">{author}</div>
					</div>
					<hr class="my-8" />
					<div class="prose">
						<slot />
					</div>
				</div>
			</article>
		</main>
		<Footer />
	</body>
</BasePage>
